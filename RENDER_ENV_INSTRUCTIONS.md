# Инструкция по настройке переменных окружения на Render

## Обзор

Эта инструкция поможет вам правильно настроить переменные окружения для CRM-системы автосервиса по электрике при развертывании на платформе Render.

## Обязательные переменные окружения

Следующие переменные окружения уже настроены в файле `render.yaml` и будут автоматически созданы при развертывании:

### 1. NODE_ENV
- **Описание**: Определяет окружение работы приложения
- **Значение**: `production`
- **Назначение**: Устанавливает режим работы приложения в продакшен

### 2. PORT
- **Описание**: Порт, на котором будет работать приложение
- **Значение**: `10000`
- **Назначение**: Указывает порт для прослушивания входящих запросов

### 3. JWT_SECRET
- **Описание**: Секретный ключ для подписи JWT токенов
- **Значение**: Автоматически генерируется Render (`generateValue: true`)
- **Назначение**: Обеспечивает безопасность аутентификации пользователей
- **Важно**: Эта переменная генерируется автоматически при развертывании и не требует ручной настройки

### 4. JWT_EXPIRES_IN
- **Описание**: Срок действия JWT токена
- **Значение**: `7d` (7 дней)
- **Назначение**: Определяет, как долго будет действителен токен аутентификации

### 5. DATABASE_URL
- **Описание**: Строка подключения к базе данных PostgreSQL
- **Значение**: Автоматически создается Render при подключении базы данных
- **Назначение**: Используется для подключения к базе данных
- **Важно**: Эта переменная создается автоматически при добавлении базы данных в Render

## Дополнительные переменные окружения (опционально)

Вы можете добавить следующие переменные окружения в панели управления Render:

### RENDER_EXTERNAL_URL
- **Описание**: Внешний URL вашего приложения
- **Значение**: `https://electric-service-crm.onrender.com` (ваш URL на Render)
- **Назначение**: Используется для формирования абсолютных ссылок в приложении

### RENDER_EXTERNAL_HOSTNAME
- **Описание**: Имя хоста вашего приложения
- **Значение**: `electric-service-crm.onrender.com` (ваше имя хоста на Render)
- **Назначение**: Используется для настройки CORS и других параметров, зависящих от хоста

## Как добавить переменные окружения в Render

1. Войдите в панель управления Render (https://dashboard.render.com)
2. Выберите ваше приложение (electric-service-crm)
3. Перейдите в раздел "Environment"
4. Нажмите кнопку "Add Environment Variable"
5. Введите имя переменной (ключ) и её значение
6. Нажмите "Save"

## Проверка переменных окружения

После развертывания вы можете проверить, что все переменные окружения правильно настроены:

1. В панели управления Render перейдите в раздел "Logs"
2. Найдите в логах сообщения о запуске приложения
3. Убедитесь, что нет ошибок, связанных с отсутствующими переменными окружения

## Локальная разработка

Для локальной разработки используйте файл `.env`, который вы можете создать на основе `.env.example`:

1. Скопируйте файл `.env.example` в `.env`:
   ```bash
   cp .env.example .env
   ```
2. Отредактируйте файл `.env`, указав свои значения для локальной разработки
3. Убедитесь, что вы не добавили `.env` в систему контроля версий (он уже в `.gitignore`)

## Безопасность

- **Никогда не храните секретные ключи в коде**
- **Используйте разные значения для JWT_SECRET в разработке и продакшене**
- **Регулярно обновляйте JWT_SECRET для повышения безопасности**
- **Не передавайте файлы .env третьим лицам**

## Устранение неполадок

Если у вас возникли проблемы с переменными окружения:

1. Проверьте, что все переменные правильно названы (учитывается регистр)
2. Убедитесь, что значения переменных корректны
3. Перезапустите приложение после изменения переменных окружения
4. Проверьте логи на наличие ошибок, связанных с переменными окружения

Для дополнительной информации обратитесь к документации Render: https://render.com/docs/environment-variables