# CRM-система для автосервиса по электрике

## Описание проекта

Это CRM-система, разработанная специально для автосервиса, специализирующегося на электромонтажных работах. Система позволяет эффективно управлять заказами, мастерами, финансами и получать аналитическую отчетность.

## Основные функции

### Управление заказами
- Создание, редактирование и удаление заказ-нарядов
- Учет работ, расходников и проданных запчастей
- Расчет общей стоимости заказа
- Управление статусами заказов

### Ролевая модель
- **Мастер:** создает, редактирует и удаляет заказ-наряды, видит только свои заказы и личную статистику
- **Директор:** видит все данные, статистику по каждому мастеру, лидерборд и может изменять проценты распределения прибыли
- **Администратор:** управляет списком мастеров (добавление, удаление, редактирование)

### Финансовый учет
- Автоматический расчет распределения прибыли между директором и мастерами
- Учет бонусов за продажу запчастей и расходников
- Различные способы оплаты (наличные, терминал, перевод)

### Аналитика и отчетность
- Дашборд с ключевыми показателями
- Графики и диаграммы для визуализации данных
- Фильтрация по дате и мастерам
- Экспорт данных в Excel/CSV

## Технологический стек

### Backend
- **Node.js** - среда выполнения JavaScript на сервере
- **Express.js** - фреймворк для создания API
- **Sequelize** - ORM для работы с PostgreSQL
- **JWT** - для аутентификации
- **bcryptjs** - для хеширования паролей
- **exceljs** - для экспорта данных в Excel

### Frontend
- **React** - библиотека для создания пользовательского интерфейса
- **React Router** - для маршрутизации
- **Axios** - для HTTP запросов к API
- **Chart.js** - для построения графиков
- **Material-UI** - библиотека компонентов

### База данных
- **PostgreSQL** - реляционная база данных

## Структура проекта

```
electric-service-crm/
├── server/                    # Backend (Node.js + Express)
│   ├── config/               # Конфигурация
│   ├── models/               # Модели Sequelize
│   ├── routes/               # API маршруты
│   ├── controllers/          # Контроллеры
│   ├── middleware/           # Middleware
│   ├── utils/                # Вспомогательные функции
│   └── index.js              # Главный файл сервера
├── client/                   # Frontend (React)
│   ├── public/               # Статические файлы
│   └── src/
│       ├── components/       # Компоненты
│       ├── pages/            # Страницы
│       ├── services/         # API сервисы
│       ├── hooks/            # Кастомные хуки
│       └── App.js            # Главный компонент
├── database/                 # SQL скрипты
├── .env.example              # Пример переменных окружения
├── .gitignore                # Файлы для исключения из Git
├── package.json              # Зависимости проекта
└── README.md                 # Документация
```

## Установка и запуск

### Клонирование репозитория
```bash
git clone https://github.com/GautamaBTC/electric-service-crm.git
cd electric-service-crm
```

### Установка зависимостей
```bash
npm run install-deps
```

### Настройка переменных окружения
Создайте файл `.env` на основе `.env.example` и заполните необходимые значения:

```
NODE_ENV=development
PORT=3000
DB_HOST=localhost
DB_PORT=5432
DB_NAME=electric_service_crm
DB_USER=postgres
DB_PASSWORD=password
JWT_SECRET=your_jwt_secret
```

### Запуск в режиме разработки
```bash
npm run dev
```

### Запуск в production режиме
```bash
npm start
```

### Запуск frontend (в отдельном терминале)
```bash
npm run client
```

## API документация

Основные эндпоинты API:

### Аутентификация
- `POST /api/auth/login` - Вход в систему
- `POST /api/auth/register` - Регистрация (только для админов)
- `GET /api/auth/me` - Получение информации о текущем пользователе

### Мастера
- `GET /api/masters` - Получение списка мастеров
- `POST /api/masters` - Создание мастера
- `PUT /api/masters/:id` - Обновление мастера
- `DELETE /api/masters/:id` - Удаление мастера

### Заказы
- `GET /api/orders` - Получение списка заказов
- `POST /api/orders` - Создание заказа
- `PUT /api/orders/:id` - Обновление заказа
- `DELETE /api/orders/:id` - Удаление заказа

### Настройки
- `GET /api/settings` - Получение настроек
- `PUT /api/settings` - Обновление настроек

### Бонусы
- `GET /api/bonuses` - Получение списка бонусов
- `POST /api/bonuses` - Создание бонуса
- `PUT /api/bonuses/:id` - Обновление бонуса
- `DELETE /api/bonuses/:id` - Удаление бонуса

### Статистика
- `GET /api/stats/dashboard` - Получение данных для дашборда
- `GET /api/stats/export` - Экспорт данных в Excel

## Развертывание

### На Render
1. Создайте аккаунт на [Render](https://render.com/)
2. Подключите GitHub-репозиторий
3. Создайте веб-сервис с следующими настройками:
   - Runtime: Node
   - Build Command: `npm install && npm run build`
   - Start Command: `node server/index.js`
4. Создайте базу данных PostgreSQL
5. Настройте переменные окружения

## Лицензия

MIT License

## Контакты

По вопросам разработки и поддержки обращайтесь к автору проекта.